# Решение типичных проблем

Этот раздел помогает диагностировать и устранять распространенные проблемы при работе с `gRPC Document Microservice`.

## Проблема: Сервер не запускается

**Симптомы**:
- Ошибка `Connection refused` при подключении к `localhost:50051`.
- Лог: `Failed to initialize database`.

**Решение**:
1. Проверьте, что Docker-контейнеры запущены:
   ```bash
   docker-compose ps
   ```
2. Убедитесь, что MongoDB (`27017`), PostgreSQL (`5432`) и Redis (`6379`) доступны.
3. Проверьте правильность `DB_TYPE` и `DB_URL` в `.env`.

## Проблема: Ошибка валидации данных

**Симптомы**:
- gRPC возвращает `INVALID_ARGUMENT` с сообщением, например, `Поле 'title' не может быть пустым`.

**Решение**:
- Проверьте входные данные в запросе (например, через `grpcurl`).
- Убедитесь, что обязательные поля (`title`, `content`, `author`) заполнены.

## Проблема: Документ не найден

**Симптомы**:
- Ошибка `NOT_FOUND` при вызове `GetDocument` или других методов.

**Решение**:
- Проверьте корректность UUID в запросе.
- Убедитесь, что документ не помечен как удаленный (`is_deleted = True`).

## Проблема: Кэш не обновляется

**Симптомы**:
- Старые данные возвращаются при вызове `GetDocument` или `ListDocuments`.

**Решение**:
- Проверьте Redis (`redis-cli`, команда `KEYS *`).
- Убедитесь, что `CACHE_TTL` в `.env` не слишком большой.
- Проверьте логи на наличие ошибок инвалидации кэша.

## Проблема: Ошибка базы данных

**Симптомы**:
- Лог: `Failed to connect to database` или `OperationFailure`.

**Решение**:
- Проверьте доступность базы данных:
  - MongoDB: `mongo mongodb://mongo:27017`.
  - PostgreSQL: `psql -h localhost -U user -d microservice_db`.
- Убедитесь, что параметры подключения в `.env` корректны.

## Дополнительная помощь

Если проблема не решена, создайте issue в репозитории или обратитесь к логам (`LOG_LEVEL=DEBUG` для большей детализации).

---

[Вернуться к оглавлению](index.md)
```